# Migration `20200904221310-add-vote-model`

This migration has been generated by Bruno Papa at 9/4/2020, 7:13:10 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "Vote" (
    "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    "linkId" INTEGER NOT NULL,
    "userId" INTEGER NOT NULL,

    FOREIGN KEY ("linkId") REFERENCES "Link"("id") ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE
)

CREATE UNIQUE INDEX "Vote.linkId_userId_unique" ON "Vote"("linkId", "userId")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200903153710-add-user-model..20200904221310-add-vote-model
--- datamodel.dml
+++ datamodel.dml
@@ -1,32 +1,44 @@
 datasource db {
   provider = "sqlite"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
 }
 // sempre que mudar o data model abaixo, é preciso rodar:
 // - para criar nova migration e aplicá-la ao db:
-//    npx prisma migrate save --name "custom-message-here" --experimental
-//    npx prisma migrate up --experimental
+//    yarn prisma migrate save --name "custom-message-here" --experimental
+//    yarn prisma migrate up --experimental
 // - to re-generate the prisma client lib:
-//    npx prisma generate
+//    yarn prisma generate
 model Link {
   id          Int      @id @default(autoincrement())
   createdAt   DateTime @default(now())
   description String
   url         String
   postedBy    User?    @relation(fields: [postedById], references: [id])
   postedById  Int?
+  votes       Vote[]
 }
 model User {
   id        Int      @id @default(autoincrement())
   name      String
   email     String   @unique
   password  String
   links     Link[]
+  votes     Vote[]
 }
+
+model Vote {
+  id     Int  @id @default(autoincrement())
+  link   Link @relation(fields: [linkId], references: [id])
+  linkId Int
+  user   User @relation(fields: [userId], references: [id])
+  userId Int
+
+  @@unique([linkId, userId])
+}
```


